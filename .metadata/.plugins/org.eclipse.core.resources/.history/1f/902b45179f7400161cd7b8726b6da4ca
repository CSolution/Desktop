package br.com.onpecas.controller;

import java.net.URL;
import java.util.ResourceBundle;

import br.com.onpecas.helper.Alerta;
import br.com.onpecas.model.Grupo;
import javafx.fxml.FXML;
import javafx.fxml.Initializable;
import javafx.scene.control.Button;
import javafx.scene.control.TextArea;
import javafx.scene.control.TextField;
import javafx.stage.Stage;

public class GrupoController implements Initializable {

	@FXML Button btnCadastrarGrupo, btnCancelar;
	@FXML TextField txtNome;
	@FXML TextArea txtDescricao;

	Stage myStage;

	private static int OID_GRUPOAUXILIO;
	@Override
	public void initialize(URL location, ResourceBundle resources) {
		// TODO Auto-generated method stub
		OID_GRUPOAUXILIO = 0;
		AtribuirBotoes();

	}

	//Terá a opção de instanciar dois modelos da classe
	//O primeiro modelo só será passado o Stage, para que possa ser fechado depois

	public GrupoController(Stage myStage) {
		// TODO Auto-generated constructor stub
		this.myStage = myStage;
	}

	//O segundo é passado, alem do stage, um objeto do tipo Grupo, para ser usado na edição
	public GrupoController(Stage myStage, Grupo grupo) {
		// TODO Auto-generated constructor stub
		this.myStage = myStage;
		PrepararUpdate(grupo);
	}

	//Esse método serve para atribuir os botões à suas funcionalidade
	private void AtribuirBotoes() {
		btnCadastrarGrupo.setOnAction(l-> InserirAtualizarGrupo());
		btnCancelar.setOnAction(l-> myStage.close());
	}

	//Metodo para se comunicar com a classe model e inserir os dados no banco
	public void InserirAtualizarGrupo(){
		String nome = txtNome.getText();
		String descricao = txtDescricao.getText();

		if(!nome.isEmpty()){
			Grupo grupo = new Grupo();

			grupo.setNome(nome);
			grupo.setDescricao(descricao);

			Grupo.Insert(grupo);

			myStage.close();

		}else{
			Alerta.showError("Não é possível criar o grupo", "O grupo precisa de um nome para ser criado.");
		}
	}

	//Metodo que sera usado para orientar na atualização dos dados
	//Esse metodo irá receber um objeto do tipo Grupo e separara seus componentes para os TextField
	//Tambem mudará o nome do botão para Atualizar
	public void PrepararUpdate(Grupo grupo){

		txtNome.setText(grupo.getNome());
		txtDescricao.setText(grupo.getDescricao());
		OID_GRUPOAUXILIO = grupo.getOid_grupo();

		btnCadastrarGrupo.setText("Atualizar");
	}
}
